"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const fs_1 = __importDefault(require("fs"));
const fs_2 = require("@agacraft/fs");
const redirect_1 = __importDefault(require("../prop/redirect"));
const fileType_1 = __importDefault(require("../utils/fileType"));
function betterResponse(request, response, next) {
    response.contentType = (type) => response.setHeader('Content-Type', type);
    response.type = (type) => response.contentType((0, fileType_1.default)(type));
    response.send = data => {
        if (typeof data === 'string' || data instanceof Buffer)
            return response.end(data);
        response.json(data);
    };
    response.json = data => {
        response.type('json').end(JSON.stringify(data));
    };
    response.sendFile = path => {
        if ((0, fs_2.isFile)(path)) {
            const type = this.getTypeFile(path);
            response.contentType(type).end(fs_1.default.readFileSync(path));
        }
        else
            next();
    };
    response.status = code => {
        response.statusCode = +code;
        return response;
    };
    response.location = function location(url) {
        return response.setHeader('Location', url);
    };
    response.redirect = (url) => (0, redirect_1.default)(url)(request, response, next);
}
exports.default = betterResponse;
